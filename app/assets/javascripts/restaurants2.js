$(document).ready(function() {  var txtgps = document.querySelector('#gps_show strong');  if (txtgps){    txtgps = document.querySelector('#gps_show strong').innerText;  }  else {    txtgps = '';  }  initMap(txtgps);  // var href=document.getElementById("demo").innerHTML ="Page location is " + window.location.href;});// Note: This example requires that you consent to location sharing when// prompted by your browser. If you see the error "The Geolocation service// failed.", it means you probably did not give permission for the browser to// locate you.//var myLatLng = {lat: -25.363, lng: 131.044};function initMap(txtgps) {  var txtcordenadas=document.querySelector('#restaurant_gps');  var map = new google.maps.Map(document.getElementById('map'), {    center: {lat: -34.397, lng: 150.644},    //center: {lat: 4.6597619867255515, lng:-74.07776326208494},    zoom: 15  });  //var marker = new google.maps.Marker({});  //marker.addListener('click', function() {}  /*google.maps.event.addListener(marker, 'click', function(){  /*map.setZoom(8);  map.setCenter(marker.getPosition());*/  /*  console.log('click de aca');});*/var infoWindow = new google.maps.InfoWindow({map: map});// Try HTML5 geolocation.if (navigator.geolocation && !txtgps) {  var txt_gps = txtgps;  navigator.geolocation.getCurrentPosition(function(position) {    var pos = {      lat: position.coords.latitude,      lng: position.coords.longitude    };    console.log('position');    console.log(txt_gps);    console.log(pos);    var myLatLng = pos;    infoWindow.setPosition(pos);    infoWindow.setContent('Location found.');    map.setCenter(pos);    console.log('true position');    console.log(myLatLng);    var marker = new google.maps.Marker({      position: myLatLng,      map: map,      draggable:true,      title:"Drag me!"    });    google.maps.event.addListener(marker, 'dragend', function(){      console.log('clic en el marcador');      myLatLng = marker.getPosition();      //pos = myLatLng.toJSON();      //pos.lat=4.6597619867255515;      //pos.lng=-74.07776326208494;      //console.log(pos);      //console.log('{lat:' + myLatLng.lat() + ',' + 'lng:' + myLatLng.lng() + '}');      //txtcordenadas.value = JSON.stringify(pos);      txtcordenadas.value = myLatLng.lat()+","+myLatLng.lng();      openInfoWindow(marker);    });    function openInfoWindow(marker) {      var markerLatLng = marker.getPosition();      infoWindow.setContent([        markerLatLng.lat(),        markerLatLng.lng(),      ].join(''));      infoWindow.open(map, marker);    }  }, function() {    handleLocationError(true, infoWindow, map.getCenter());  });}else {  // Browser doesn't support Geolocation  handleLocationError(false, infoWindow, map.getCenter());}  if (txtgps) {    var txt_gps = txtgps;    txt_gps=txt_gps.split(",");    console.log("este",txt_gps);    navigator.geolocation.getCurrentPosition(function(position) {      var pos = {        // lat: txt_gps[0],        // lng: txt_gps[1]        lat: Number.parseFloat(txt_gps[0]),        lng: Number.parseFloat(txt_gps[1])      };      console.log('position');      console.log(txt_gps);      console.log(pos);      var myLatLng = pos;      infoWindow.setPosition(pos);      infoWindow.setContent('Location found.');      map.setCenter(pos);      console.log('true position');      console.log('dddd',myLatLng);      var marker = new google.maps.Marker({        position: myLatLng,        map: map,        draggable:true,        title:"Drag me!"      });      google.maps.event.addListener(marker, 'dragend', function(){        console.log('clic en el marcador');        myLatLng = marker.getPosition();        //pos = myLatLng.toJSON();        pos.lat=Number.parseFloat(txt_gps[0]);        pos.lng=-Number.parseFloat(txt_gps[1]);        console.log('ps',pos);        //console.log('{lat:' + myLatLng.lat() + ',' + 'lng:' + myLatLng.lng() + '}');        //xtcordenadas.value = JSON.stringify(pos);        //txtcordenadas.value = myLatLng.lat()+","+myLatLng.lng();        openInfoWindow(marker);      });      function openInfoWindow(marker) {        var markerLatLng = marker.getPosition();        infoWindow.setContent([          markerLatLng.lat(),          markerLatLng.lng(),        ].join(''));        infoWindow.open(map, marker);      }    }, function() {      handleLocationError(true, infoWindow, map.getCenter());    });  }  else{      navigator.geolocation.getCurrentPosition(function(position) {        var pos = {          lat: 4.6597619867255515,          lng: 4.6597619867255515        };        console.log('position');        console.log(txt_gps);        console.log(pos);        var myLatLng = pos;        infoWindow.setPosition(pos);        infoWindow.setContent('Location found.');        map.setCenter(pos);        console.log('true position');        console.log('dddd',myLatLng);        var marker = new google.maps.Marker({          position: myLatLng,          map: map,          draggable:true,          title:"Drag me!"        });        google.maps.event.addListener(marker, 'dragend', function(){          console.log('clic en el marcador');          myLatLng = marker.getPosition();          //pos = myLatLng.toJSON();          pos.lat=Number.parseFloat(txt_gps[0]);          pos.lng=-Number.parseFloat(txt_gps[1]);          console.log('ps',pos);          //console.log('{lat:' + myLatLng.lat() + ',' + 'lng:' + myLatLng.lng() + '}');          //xtcordenadas.value = JSON.stringify(pos);          //txtcordenadas.value = myLatLng.lat()+","+myLatLng.lng();          openInfoWindow(marker);        });        function openInfoWindow(marker) {          var markerLatLng = marker.getPosition();          infoWindow.setContent([            markerLatLng.lat(),            markerLatLng.lng(),          ].join(''));          infoWindow.open(map, marker);        }      }, function() {        handleLocationError(true, infoWindow, map.getCenter());      });  }}function handleLocationError(browserHasGeolocation, infoWindow, pos) {  infoWindow.setPosition(pos);  infoWindow.setContent(browserHasGeolocation ?    'Error: The Geolocation service failed.' :    'Error: Your browser doesn\'t support geolocation.');  }